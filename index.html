<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Audio Player Editor for Genially</title>
    <style>
        :root { --primary: #7b2ff7; --secondary: #ffffff; }
        body { font-family: 'Segoe UI', system-ui, sans-serif; background: #f0f2f5; margin: 0; padding: 20px; color: #1a1a1b; }
        .editor-container { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; max-width: 1200px; margin: 0 auto; }
        .panel { background: white; padding: 25px; border-radius: 16px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); }
        h2 { margin-top: 0; font-size: 1.2rem; border-bottom: 2px solid #eee; padding-bottom: 10px; }
        
        /* Settings Styles */
        .field { margin-bottom: 15px; }
        label { display: block; font-size: 0.9rem; font-weight: 600; margin-bottom: 5px; }
        input[type="text"], input[type="color"] { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; }
        button#generate { background: var(--primary); color: white; border: none; padding: 12px; border-radius: 8px; width: 100%; cursor: pointer; font-weight: bold; margin-top: 10px; }
        textarea#embedCode { width: 100%; height: 120px; margin-top: 15px; border-radius: 8px; font-family: monospace; font-size: 12px; background: #f8f9fa; }

        /* PLAYER STYLES (Reference-like) */
        .player-card {
            width: 450px; height: 180px;
            background: linear-gradient(135deg, var(--primary) 0%, #4a148c 100%);
            border-radius: 20px; position: relative; padding: 20px;
            color: white; display: flex; align-items: center; overflow: hidden;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        }
        .album-art-container { position: relative; z-index: 2; margin-right: 20px; }
        .album-art { 
            width: 110px; height: 110px; border-radius: 50%; 
            border: 4px solid rgba(255,255,255,0.2); object-fit: cover;
            animation: rotate 10s linear infinite paused;
        }
        .player-card.playing .album-art { animation-play-state: running; }
        
        .player-info { flex: 1; z-index: 2; }
        .track-title { font-size: 18px; font-weight: bold; margin: 0; }
        .artist-name { font-size: 14px; opacity: 0.7; margin: 5px 0; }
        
        .player-controls { display: flex; align-items: center; gap: 15px; margin-top: 15px; }
        .btn { background: none; border: none; color: white; cursor: pointer; font-size: 20px; transition: 0.2s; }
        .btn:hover { transform: scale(1.1); }
        .btn-play { background: rgba(255,255,255,0.2); width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; }

        .progress-container { width: 100%; height: 4px; background: rgba(255,255,255,0.2); border-radius: 2px; margin-top: 10px; cursor: pointer; }
        .progress-fill { height: 100%; background: var(--secondary); width: 0%; border-radius: 2px; }
        
        /* Visualizer imitation */
        .visualizer { position: absolute; bottom: 0; left: 0; display: flex; gap: 2px; align-items: flex-end; padding: 10px; opacity: 0.3; }
        .bar { width: 8px; background: white; border-radius: 2px 2px 0 0; animation: bounce 1s ease-in-out infinite alternate; }

        @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        @keyframes bounce { from { height: 5px; } to { height: 40px; } }
    </style>
</head>
<body>

    <div class="editor-container">
        <div class="panel">
            <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–ª–µ–µ—Ä–∞</h2>
            <div class="field">
                <label>–û—Å–Ω–æ–≤–Ω–æ–π —Ü–≤–µ—Ç (–ì—Ä–∞–¥–∏–µ–Ω—Ç)</label>
                <input type="color" id="color1" value="#7b2ff7">
            </div>
            <div class="field">
                <label>–¶–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞ –∏ –∞–∫—Ü–µ–Ω—Ç–æ–≤</label>
                <input type="color" id="color2" value="#ffffff">
            </div>
            <div class="field">
                <label>–°—Å—ã–ª–∫–∞ –Ω–∞ JSON –ø–ª–µ–π–ª–∏—Å—Ç–∞</label>
                <input type="text" id="jsonUrl" value="https://raw.githubusercontent.com/EnglishTeacherOlgaKutsepalova/player/main/playlist.json">
            </div>
            <button id="generate" onclick="copyCode()">–ü–æ–ª—É—á–∏—Ç—å –∫–æ–¥ –¥–ª—è Genially</button>
            <textarea id="embedCode" readonly placeholder="–ó–¥–µ—Å—å –ø–æ—è–≤–∏—Ç—Å—è –∫–æ–¥..."></textarea>
        </div>

        <div class="panel">
            <h2>–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä</h2>
            <div id="preview">
                <div class="player-card" id="mainPlayer">
                    <div class="visualizer">
                        <div class="bar" style="animation-delay: 0.1s"></div>
                        <div class="bar" style="animation-delay: 0.3s"></div>
                        <div class="bar" style="animation-delay: 0.2s"></div>
                        <div class="bar" style="animation-delay: 0.4s"></div>
                    </div>
                    <div class="album-art-container">
                        <img src="https://raw.githubusercontent.com/EnglishTeacherOlgaKutsepalova/player/main/cover.jpg" class="album-art" id="art">
                    </div>
                    <div class="player-info">
                        <p class="track-title" id="t-title">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–µ–∫–∞</p>
                        <p class="artist-name" id="t-artist">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å</p>
                        <div class="progress-container">
                            <div class="progress-fill" id="prog"></div>
                        </div>
                        <div class="player-controls">
                            <button class="btn" onclick="prev()">‚èÆ</button>
                            <button class="btn btn-play" onclick="togglePlay()" id="playIcon">‚ñ∂</button>
                            <button class="btn" onclick="next()">‚è≠</button>
                            <button class="btn" onclick="toggleShuffle()" id="shuffleBtn" title="Shuffle">üîÄ</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

<script>
    let tracks = [];
    let currentIndex = 0;
    let isPlaying = false;
    let isShuffle = true;
    const audio = new Audio();

    // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
    async function init() {
        const url = document.getElementById('jsonUrl').value;
        try {
            const res = await fetch(url);
            const data = await res.json();
            tracks = data.tracks;
            loadTrack(0);
        } catch (e) { console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–ª–µ–π–ª–∏—Å—Ç–∞"); }
    }

    function loadTrack(index) {
        const track = tracks[index];
        const base = "https://raw.githubusercontent.com/EnglishTeacherOlgaKutsepalova/player/main/";
        audio.src = base + track.file;
        document.getElementById('t-title').innerText = track.title;
        document.getElementById('t-artist').innerText = track.artist;
        document.getElementById('art').src = base + track.image;
    }

    function togglePlay() {
        if (isPlaying) { audio.pause(); } else { audio.play(); }
        isPlaying = !isPlaying;
        document.getElementById('playIcon').innerText = isPlaying ? '‚è∏' : '‚ñ∂';
        document.getElementById('mainPlayer').classList.toggle('playing', isPlaying);
    }

    function next() {
        currentIndex = isShuffle ? Math.floor(Math.random() * tracks.length) : (currentIndex + 1) % tracks.length;
        loadTrack(currentIndex);
        if (isPlaying) audio.play();
    }

    function prev() {
        currentIndex = (currentIndex - 1 + tracks.length) % tracks.length;
        loadTrack(currentIndex);
        if (isPlaying) audio.play();
    }

    function toggleShuffle() {
        isShuffle = !isShuffle;
        document.getElementById('shuffleBtn').style.opacity = isShuffle ? "1" : "0.5";
    }

    audio.ontimeupdate = () => {
        const percent = (audio.currentTime / audio.duration) * 100;
        document.getElementById('prog').style.width = percent + '%';
    };

    audio.onended = () => next();

    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏)
    function copyCode() {
        const c1 = document.getElementById('color1').value;
        const c2 = document.getElementById('color2').value;
        const json = document.getElementById('jsonUrl').value;
        
        const code = `<iframe src="https://englishteacherolgakutsepalova.github.io/player/index.html?c1=${c1.replace('#','')}&c2=${c2.replace('#','')}" width="460" height="200" frameborder="0"></iframe>`;
        document.getElementById('embedCode').value = code;
        alert("–ö–æ–¥ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω! –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–≥–æ –≤ Genially —á–µ—Ä–µ–∑ 'Insert' -> 'Others'");
    }

    init();
</script>
</body>
</html>
